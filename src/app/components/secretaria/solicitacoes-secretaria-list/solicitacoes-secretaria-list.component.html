<div class="container mt-4">
    <div class="pagetitle">
      <h1>Solicitações dos Alunos</h1>
      <p class="text-muted">Gerencie as solicitações enviadas pelos alunos.</p>
    </div>
  
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Filtros</h5>
  
        <div class="row g-3">
          <div class="col-md-6">
            <label for="statusFilter" class="form-label">Status da Solicitação</label>
            <select id="statusFilter" class="form-select" [(ngModel)]="selectedStatus" (ngModelChange)="onFilterChange()">
              <option *ngFor="let status of statusOptions" [value]="status">{{ status }}</option>
            </select>
          </div>
          <div class="col-md-6">
            <label for="campusFilter" class="form-label">Campus</label>
            <select id="campusFilter" class="form-select" [(ngModel)]="selectedCampus" (ngModelChange)="onFilterChange()">
              <option [ngValue]="undefined">Todos os Campi</option>
              <option *ngFor="let campus of campi" [value]="campus">{{ campus }}</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  
    <div class="card mt-4">
      <div class="card-body">
        <h5 class="card-title">Lista de Solicitações</h5>
  
        <div *ngIf="isLoading" class="text-center">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Carregando...</span>
          </div>
        </div>
  
        <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
  
        <div *ngIf="!isLoading && !error && filteredSolicitacoes.length > 0" class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th scope="col">Protocolo</th>
                <th scope="col">Matrícula</th>
                <th scope="col">Nome do Aluno</th>
                <th scope="col">Tipo de Solicitação</th>
                <th scope="col">Campus</th>
                <th scope="col">Ações</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let s of filteredSolicitacoes" [ngClass]="{
                'table-success': selectedStatus === 'CONCLUIDA',
                'table-danger': selectedStatus === 'REJEITADA',
                'table-warning': selectedStatus === 'ABERTA'
              }">
                <td>{{ s.protocolo }}</td>
                <td>{{ s.matriculaAluno }}</td>
                <td>{{ s.nomeAluno }}</td>
                <td>{{ s.tipo }}</td>
                <td>{{ s.campus }}</td>
                <td>
                  <button class="btn btn-info me-2" [routerLink]="['/solicitacoes/detalhes', s.id]">Ver Detalhes</button>
                  <ng-container *ngIf="selectedStatus === 'ABERTA'">
                    <button class="btn btn-success me-2" (click)="aprovar(s.id)" title="Aprovar">
                      <i class="bi bi-check-lg"></i> Aprovar
                    </button>
                    <button class="btn btn-danger" (click)="rejeitar(s.id)" title="Rejeitar">
                      <i class="bi bi-x-lg"></i> Rejeitar
                    </button>
                  </ng-container>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
  
        <div *ngIf="!isLoading && !error && filteredSolicitacoes.length === 0" class="text-center mt-3">
          Nenhuma solicitação encontrada para os filtros selecionados.
        </div>
      </div>
    </div>
  </div>
  